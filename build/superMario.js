"use strict";var newElement=document.createElement("div"),newContent=document.createTextNode("");newElement.classList.add("content"),newElement.appendChild(newContent);var htmlBody=document.getElementsByTagName("body")[0];htmlBody.appendChild(newElement);var scaling=3,canvas=document.createElement("canvas");canvas.id="canvas",canvas.width=256*scaling,canvas.height=240*scaling,newElement.appendChild(canvas);var c=canvas.getContext("2d");c.scale(scaling,scaling);var input={up:!1,down:!1,left:!1,right:!1,a:!1,b:!1,start:!1,select:!1};function moveSomething(e){switch(e.keyCode){case 38:input.up=!0;break;case 40:input.down=!0;break;case 37:input.left=!0;break;case 39:input.right=!0;break;case 32:input.a=!0;break;case 16:input.b=!0}}function stopSomething(e){switch(e.keyCode){case 38:input.up=!1;break;case 40:input.down=!1;break;case 37:input.left=!1;break;case 39:input.right=!1;break;case 32:input.a=!1;break;case 16:input.b=!1}}window.addEventListener("keydown",moveSomething),window.addEventListener("keyup",stopSomething);var nesColor=[{c00:"#656565",c01:"#002d69",c02:"#131f7f",c03:"#3c137c",c04:"#600b62",c05:"#ac0028",c06:"#710f07",c07:"#5a1a00",c08:"#342800",c09:"#0b3400",c0A:"#003c00",c0B:"#003d10",c0C:"#003840",c0D:"#000000",c10:"#aeaeae",c11:"#0f63b3",c12:"#4051d0",c13:"#7841cc",c14:"#a736a9",c15:"#c03470",c16:"#bd3c30",c17:"#e46018",c18:"#6d5c00",c19:"#366d00",c1A:"#077704",c1B:"#00793d",c1C:"#008894",c1D:"#000000",c20:"#fefeff",c21:"#5db3ff",c22:"#8fa1ff",c23:"#c890ff",c24:"#f785fa",c25:"#ff83c0",c26:"#ff8b7f",c27:"#fca048",c28:"#bdac2c",c29:"#85bc2f",c2A:"#55c753",c2B:"#3cc98c",c2C:"#3ec2cd",c2D:"#4e4e4e",c30:"#fefeff",c31:"#a4e8fc",c32:"#d1d8ff",c33:"#e8d1ff",c34:"#fbcdfd",c35:"#ffcce5",c36:"#ffcfca",c37:"#fce0b4",c38:"#e4dca8",c39:"#cce3a9",c3A:"#b9e8b8",c3B:"#aee8d0",c3C:"#afe5ea",c3D:"#b6b6b6",cFF:"rgba(255, 0, 255, 0)"}],objects={mario:{size:[{x:16,y:16},{x:16,y:32}],sprite:[[0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,3,3,3,2,2,3,2,0,0,0,0,0,0,0,0,3,2,3,2,2,2,3,2,2,2,0,0,0,0,0,0,3,2,3,3,2,2,2,3,2,2,2,0,0,0,0,0,3,3,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,3,3,1,3,3,3,0,0,0,0,0,0,0,0,0,3,3,3,1,3,3,1,3,3,3,0,0,0,0,0,3,3,3,3,1,3,3,1,3,3,3,3,0,0,0,0,2,2,3,1,2,1,1,2,1,3,2,2,0,0,0,0,2,2,2,1,1,1,1,1,1,2,2,2,0,0,0,0,2,2,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,0,0,0,3,3,3,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,0,0,0,0,3,3,3,3,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,3,3,3,2,2,3,2,0,0,0,0,0,0,0,0,3,2,3,2,2,2,3,2,2,2,0,0,0,0,0,0,3,2,3,3,2,2,2,3,2,2,2,0,0,0,0,0,3,3,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,3,3,3,3,1,3,0,2,0,0,0,0,0,0,0,2,3,3,3,3,3,3,2,2,2,0,0,0,0,0,2,2,1,3,3,3,3,3,2,2,0,0,0,0,0,0,3,3,1,1,1,1,1,1,1,0,0,0,0,0,0,0,3,1,1,1,1,1,1,1,1,0,0,0,0,0,0,3,3,1,1,1,0,1,1,1,0,0,0,0,0,0,0,3,0,0,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,0,0],[0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,3,3,3,2,2,3,2,0,0,0,0,0,0,0,0,3,2,3,2,2,2,3,2,2,2,0,0,0,0,0,0,3,2,3,3,2,2,2,3,2,2,2,0,0,0,0,0,3,3,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,3,3,1,3,3,3,0,0,0,0,0,0,0,0,0,3,3,3,3,1,1,3,3,0,0,0,0,0,0,0,0,3,3,3,1,1,2,1,1,2,0,0,0,0,0,0,0,3,3,3,3,1,1,1,1,1,0,0,0,0,0,0,0,1,3,3,2,2,2,1,1,1,0,0,0,0,0,0,0,0,1,3,2,2,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,3,3,3,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0],[0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,3,3,3,2,2,3,2,0,0,0,0,0,0,0,0,3,2,3,2,2,2,3,2,2,2,0,0,0,0,0,0,3,2,3,3,2,2,2,3,2,2,2,0,0,0,0,0,3,3,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,3,3,3,3,1,1,3,3,0,0,0,0,0,0,2,2,3,3,3,3,1,1,1,3,3,3,2,2,2,0,2,2,2,0,3,3,1,2,1,1,1,3,3,2,2,0,2,2,0,0,1,1,1,1,1,1,1,0,0,3,0,0,0,0,0,1,1,1,1,1,1,1,1,1,3,3,0,0,0,0,1,1,1,1,1,1,1,1,1,1,3,3,0,0,0,3,3,1,1,1,0,0,0,1,1,1,3,3,0,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,1,1,1,1,1,0,0,2,2,2,0,0,0,0,0,1,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,3,3,3,2,2,3,2,0,3,3,3,0,0,0,0,3,2,3,2,2,2,3,2,2,3,3,3,0,0,0,0,3,2,3,3,2,2,2,3,2,2,2,3,0,0,0,0,3,3,2,2,2,2,3,3,3,3,3,0,0,0,0,0,0,0,2,2,2,2,2,2,2,3,0,0,0,0,3,3,3,3,3,1,3,3,3,1,3,0,0,0,0,3,3,3,3,3,3,3,1,3,3,3,1,0,0,3,2,2,3,3,3,3,3,3,1,1,1,1,1,0,0,3,2,2,2,0,1,1,3,1,1,2,1,1,2,1,3,3,0,2,0,3,1,1,1,1,1,1,1,1,1,1,3,3,0,0,3,3,3,1,1,1,1,1,1,1,1,1,3,3,0,3,3,3,1,1,1,1,1,1,1,0,0,0,0,0,0,3,0,0,1,1,1,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,3,3,3,2,2,3,2,2,2,0,0,0,0,0,0,3,2,2,3,2,2,3,3,2,2,2,2,0,0,0,0,3,2,2,3,3,2,2,2,2,2,2,2,2,0,0,3,3,2,2,3,3,2,2,2,3,2,2,2,2,0,0,3,3,2,2,2,2,2,3,3,3,3,3,3,0,0,0,3,3,3,2,2,2,2,2,3,3,3,3,3,0,0,0,0,0,3,3,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,3,2,2,2,2,2,3,0,0,0,0,0,0,0,0,0,3,1,3,3,3,3,1,3,0,0,0,0,0,0,0,3,3,1,3,3,3,3,1,3,3,0,0,0,0,0,3,3,3,1,3,3,3,3,1,3,3,3,0,0,0,3,3,3,3,1,3,3,3,3,1,3,3,3,3,0,0,3,3,3,1,1,3,3,3,3,1,1,3,3,3,0,3,3,3,3,1,1,3,3,3,3,1,1,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,1,2,1,1,1,1,2,1,3,3,3,3,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,0,2,2,2,1,1,1,1,1,1,1,1,2,2,2,0,0,2,2,1,1,1,1,1,1,1,1,1,1,2,2,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,1,1,0,0,0,3,3,3,3,0,0,0,0,3,3,3,3,0,0,0,0,3,3,3,3,0,0,0,0,3,3,3,3,0,0,3,3,3,3,3,3,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,3,3,3,3,3,3]],palette:[[nesColor[0].cFF,nesColor[0].c16,nesColor[0].c27,nesColor[0].c18],[nesColor[0].cFF,nesColor[0].c30,nesColor[0].c27,nesColor[0].c18],[nesColor[0].cFF,nesColor[0].c37,nesColor[0].c27,nesColor[0].c05]]},floor:{size:[{x:16,y:16}],sprite:[[2,1,1,1,1,1,1,1,1,3,2,1,1,1,1,2,1,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,1,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,1,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,1,2,2,2,2,2,2,2,2,3,1,3,2,2,2,3,1,2,2,2,2,2,2,2,2,3,1,3,3,3,3,2,1,2,2,2,2,2,2,2,2,3,1,1,1,1,1,3,1,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,1,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,1,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,3,3,2,2,2,2,2,2,3,1,2,2,2,2,2,3,1,1,3,3,2,2,2,2,3,1,2,2,2,2,2,3,1,2,1,1,3,3,3,3,1,2,2,2,2,2,2,3,1,2,2,2,1,1,1,3,1,2,2,2,2,2,2,3,1,2,2,2,2,2,2,3,1,2,2,2,2,2,3,3,2,3,3,3,3,3,3,2,1,3,3,3,3,3,3,2]],palette:[[nesColor[0].cFF,nesColor[0].c37,nesColor[0].c17,nesColor[0].c0D],[nesColor[0].cFF,nesColor[0].c31,nesColor[0].c1C,nesColor[0].c0D]]},mushroom:{size:[{x:16,y:16}],sprite:[[0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,3,3,0,0,0,0,0,0,0,0,0,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,2,2,2,2,2,3,3,3,3,3,0,0,0,0,0,2,2,2,2,2,2,2,3,3,3,2,2,0,0,0,2,2,3,3,3,2,2,2,2,2,2,2,2,2,0,0,2,3,3,3,3,3,2,2,2,2,2,2,2,2,0,2,2,3,3,3,3,3,2,2,2,2,2,3,3,2,2,2,2,3,3,3,3,3,2,2,2,2,2,3,3,3,2,2,2,2,3,3,3,2,2,2,2,2,2,2,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,3,3,3,1,1,1,1,1,1,3,3,3,2,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,2,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,2,1,0,0,0,0,0,0,0,0,0,1,1,1,1,2,1,0,0,0,0,0]],palette:[[nesColor[0].cFF,nesColor[0].c20,nesColor[0].c27,nesColor[0].c16]]},qstBlock:{size:[{x:16,y:16}],sprite:[[0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,2,1,3,1,1,1,1,1,1,1,1,1,1,3,1,3,2,1,1,1,1,2,2,2,2,2,1,1,1,1,1,3,2,1,1,1,2,2,3,3,3,2,2,1,1,1,1,3,2,1,1,1,2,2,3,1,1,2,2,3,1,1,1,3,2,1,1,1,2,2,3,1,1,2,2,3,1,1,1,3,2,1,1,1,1,3,3,1,2,2,2,3,1,1,1,3,2,1,1,1,1,1,1,2,2,3,3,3,1,1,1,3,2,1,1,1,1,1,1,2,2,3,1,1,1,1,1,3,2,1,1,1,1,1,1,1,3,3,1,1,1,1,1,3,2,1,1,1,1,1,1,2,2,1,1,1,1,1,1,3,2,1,1,1,1,1,1,2,2,3,1,1,1,1,1,3,2,1,3,1,1,1,1,1,3,3,1,1,1,3,1,3,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]],palette:[[nesColor[0].cFF,nesColor[0].c27,nesColor[0].c17,nesColor[0].c0D]]},brick:{size:[{x:16,y:16}],sprite:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]],palette:[[nesColor[0].cFF,nesColor[0].c37,nesColor[0].c17,nesColor[0].c0D]]},titleScreen:{size:[{x:137,y:86}],sprite:[[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3]],palette:[[nesColor[0].cFF,nesColor[0].c37,nesColor[0].c17,nesColor[0].c0D]]},empty:{sprite:[[]],palette:[[]]}};function backgroundColor(e){c.fillStyle=e,c.fillRect(0,0,canvas.width,canvas.height)}function floor(e,o){for(var t=0;t<2;t++)for(var r=0;r<o;r++)for(var n=0;n<16;n++)for(var s=0;s<16;s++)c.fillStyle=objects.floor.palette[0][objects.floor.sprite[0][s+n*objects.floor.size[0].x]],c.fillRect(s+16*r+16*e,n+208+16*t,1,1)}function drawBackgroundLayer(){backgroundColor(nesColor[0].c21),floor(0,16)}var currentSprite=4,xPos=120,yPos=0,isOnGround=!1;function moveMario(){var e;!0===input.right&&(e=2),!0===input.left&&(e=-2),!0===isOnGround&&(xPos+=e),3<++currentSprite&&(currentSprite=1)}function drawMario(){for(var e=0;e<objects.mario.size[0].y;e++)for(var o=0;o<objects.mario.size[0].x;o++)c.fillStyle=objects.mario.palette[0][objects.mario.sprite[currentSprite][o+e*objects.mario.size[0].x]],c.fillRect(o+xPos,e+yPos,1,1);256<xPos&&(xPos=-16),xPos<-16&&(xPos=256),!0===input.a&&(isOnGround=!1,yPos=0),!1===isOnGround&&(yPos=1.1*++yPos),193<yPos&&(isOnGround=!0),!0===isOnGround&&(yPos=193),!0===isOnGround&&!1===input.right&&!1===input.left&&(currentSprite=0),!1===isOnGround&&!1===input.right&&!1===input.left&&(currentSprite=4)}function drawMushroom(){for(var e=0;e<objects.mushroom.size[0].y;e++)for(var o=0;o<objects.mushroom.size[0].x;o++)c.fillStyle=objects.mushroom.palette[0][objects.mushroom.sprite[0][o+e*objects.mushroom.size[0].x]],c.fillRect(o,e,1,1)}function drawBrick(e,o){for(var t=0;t<objects.brick.size[0].y;t++)for(var r=0;r<objects.brick.size[0].x;r++)c.fillStyle=objects.brick.palette[0][objects.brick.sprite[0][r+t*objects.brick.size[0].x]],c.fillRect(r+16*e,t+16*o,1,1)}function drawQstBlock(e,o){for(var t=0;t<objects.qstBlock.size[0].y;t++)for(var r=0;r<objects.qstBlock.size[0].x;r++)c.fillStyle=objects.qstBlock.palette[0][objects.qstBlock.sprite[0][r+t*objects.qstBlock.size[0].x]],c.fillRect(r+16*e,t+16*o,1,1)}function spriteViewer(e,o,t,r){for(var n=0;n<objects.titleScreen.size[o].y;n++)for(var s=0;s<objects.titleScreen.size[o].x;s++)c.fillStyle=objects.titleScreen.palette[r][objects.titleScreen.sprite[t][s+n*objects.titleScreen.size[o].x]],c.fillRect(s,n,1,1)}function drawSpriteLayer(){drawMario(),drawQstBlock(8,9),drawBrick(11,9),drawQstBlock(12,9),drawBrick(13,9),drawQstBlock(13,5),drawQstBlock(14,9),drawBrick(15,9),!0!==input.right&&!0!==input.left||moveMario()}function render(){c.clearRect(0,0,canvas.width,canvas.height),drawBackgroundLayer(),drawSpriteLayer(),console.clear(),console.log("up = "+input.up),console.log("down = "+input.down),console.log("left = "+input.left),console.log("right = "+input.right),console.log("a = "+input.a),console.log("b = "+input.b),console.log(isOnGround)}setInterval(render,1e3/60);