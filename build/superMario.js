"use strict";var newElement=document.createElement("div"),newContent=document.createTextNode("");newElement.classList.add("content"),newElement.appendChild(newContent);var htmlBody=document.getElementsByTagName("body")[0];htmlBody.appendChild(newElement);var scaling=3,canvas=document.createElement("canvas");canvas.id="canvas",canvas.width=256*scaling,canvas.height=240*scaling,newElement.appendChild(canvas);var c=canvas.getContext("2d");c.scale(scaling,scaling);var input={up:!1,down:!1,left:!1,right:!1,a:!1,b:!1,start:!1,select:!1};function moveSomething(e){switch(e.keyCode){case 38:input.up=!0;break;case 40:input.down=!0;break;case 37:input.left=!0;break;case 39:input.right=!0;break;case 32:input.a=!0;break;case 16:input.b=!0}}function stopSomething(e){switch(e.keyCode){case 38:input.up=!1;break;case 40:input.down=!1;break;case 37:input.left=!1;break;case 39:input.right=!1;break;case 32:input.a=!1;break;case 16:input.b=!1}}window.addEventListener("keydown",moveSomething),window.addEventListener("keyup",stopSomething);var nesColor=[{c00:"#656565",c01:"#002d69",c02:"#131f7f",c03:"#3c137c",c04:"#600b62",c05:"#ac0028",c06:"#710f07",c07:"#5a1a00",c08:"#342800",c09:"#0b3400",c0A:"#003c00",c0B:"#003d10",c0C:"#003840",c0D:"#000000",c10:"#aeaeae",c11:"#0f63b3",c12:"#4051d0",c13:"#7841cc",c14:"#a736a9",c15:"#c03470",c16:"#bd3c30",c17:"#e46018",c18:"#6d5c00",c19:"#366d00",c1A:"#077704",c1B:"#00793d",c1C:"#008894",c1D:"#000000",c20:"#fefeff",c21:"#5db3ff",c22:"#8fa1ff",c23:"#c890ff",c24:"#f785fa",c25:"#ff83c0",c26:"#ff8b7f",c27:"#fca048",c28:"#bdac2c",c29:"#85bc2f",c2A:"#55c753",c2B:"#3cc98c",c2C:"#3ec2cd",c2D:"#4e4e4e",c30:"#fefeff",c31:"#a4e8fc",c32:"#d1d8ff",c33:"#e8d1ff",c34:"#fbcdfd",c35:"#ffcce5",c36:"#ffcfca",c37:"#fce0b4",c38:"#e4dca8",c39:"#cce3a9",c3A:"#b9e8b8",c3B:"#aee8d0",c3C:"#afe5ea",c3D:"#b6b6b6",cFF:"rgba(255, 0, 255, 0)"}],objects={mario:{size:[{x:16,y:16},{x:16,y:32}],sprite:[[0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,3,3,3,2,2,3,2,0,0,0,0,0,0,0,0,3,2,3,2,2,2,3,2,2,2,0,0,0,0,0,0,3,2,3,3,2,2,2,3,2,2,2,0,0,0,0,0,3,3,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,3,3,1,3,3,3,0,0,0,0,0,0,0,0,0,3,3,3,1,3,3,1,3,3,3,0,0,0,0,0,3,3,3,3,1,3,3,1,3,3,3,3,0,0,0,0,2,2,3,1,2,1,1,2,1,3,2,2,0,0,0,0,2,2,2,1,1,1,1,1,1,2,2,2,0,0,0,0,2,2,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,0,0,0,3,3,3,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,0,0,0,0,3,3,3,3,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,3,3,3,2,2,3,2,0,0,0,0,0,0,0,0,3,2,3,2,2,2,3,2,2,2,0,0,0,0,0,0,3,2,3,3,2,2,2,3,2,2,2,0,0,0,0,0,3,3,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,3,3,3,3,1,3,0,2,0,0,0,0,0,0,0,2,3,3,3,3,3,3,2,2,2,0,0,0,0,0,2,2,1,3,3,3,3,3,2,2,0,0,0,0,0,0,3,3,1,1,1,1,1,1,1,0,0,0,0,0,0,0,3,1,1,1,1,1,1,1,1,0,0,0,0,0,0,3,3,1,1,1,0,1,1,1,0,0,0,0,0,0,0,3,0,0,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,0,0],[0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,3,3,3,2,2,3,2,0,0,0,0,0,0,0,0,3,2,3,2,2,2,3,2,2,2,0,0,0,0,0,0,3,2,3,3,2,2,2,3,2,2,2,0,0,0,0,0,3,3,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,3,3,1,3,3,3,0,0,0,0,0,0,0,0,0,3,3,3,3,1,1,3,3,0,0,0,0,0,0,0,0,3,3,3,1,1,2,1,1,2,0,0,0,0,0,0,0,3,3,3,3,1,1,1,1,1,0,0,0,0,0,0,0,1,3,3,2,2,2,1,1,1,0,0,0,0,0,0,0,0,1,3,2,2,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,3,3,3,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0],[0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,3,3,3,2,2,3,2,0,0,0,0,0,0,0,0,3,2,3,2,2,2,3,2,2,2,0,0,0,0,0,0,3,2,3,3,2,2,2,3,2,2,2,0,0,0,0,0,3,3,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,3,3,3,3,1,1,3,3,0,0,0,0,0,0,2,2,3,3,3,3,1,1,1,3,3,3,2,2,2,0,2,2,2,0,3,3,1,2,1,1,1,3,3,2,2,0,2,2,0,0,1,1,1,1,1,1,1,0,0,3,0,0,0,0,0,1,1,1,1,1,1,1,1,1,3,3,0,0,0,0,1,1,1,1,1,1,1,1,1,1,3,3,0,0,0,3,3,1,1,1,0,0,0,1,1,1,3,3,0,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,1,1,1,1,1,0,0,2,2,2,0,0,0,0,0,1,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,3,3,3,2,2,3,2,0,3,3,3,0,0,0,0,3,2,3,2,2,2,3,2,2,3,3,3,0,0,0,0,3,2,3,3,2,2,2,3,2,2,2,3,0,0,0,0,3,3,2,2,2,2,3,3,3,3,3,0,0,0,0,0,0,0,2,2,2,2,2,2,2,3,0,0,0,0,3,3,3,3,3,1,3,3,3,1,3,0,0,0,0,3,3,3,3,3,3,3,1,3,3,3,1,0,0,3,2,2,3,3,3,3,3,3,1,1,1,1,1,0,0,3,2,2,2,0,1,1,3,1,1,2,1,1,2,1,3,3,0,2,0,3,1,1,1,1,1,1,1,1,1,1,3,3,0,0,3,3,3,1,1,1,1,1,1,1,1,1,3,3,0,3,3,3,1,1,1,1,1,1,1,0,0,0,0,0,0,3,0,0,1,1,1,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,3,3,3,2,2,3,2,2,2,0,0,0,0,0,0,3,2,2,3,2,2,3,3,2,2,2,2,0,0,0,0,3,2,2,3,3,2,2,2,2,2,2,2,2,0,0,3,3,2,2,3,3,2,2,2,3,2,2,2,2,0,0,3,3,2,2,2,2,2,3,3,3,3,3,3,0,0,0,3,3,3,2,2,2,2,2,3,3,3,3,3,0,0,0,0,0,3,3,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,3,2,2,2,2,2,3,0,0,0,0,0,0,0,0,0,3,1,3,3,3,3,1,3,0,0,0,0,0,0,0,3,3,1,3,3,3,3,1,3,3,0,0,0,0,0,3,3,3,1,3,3,3,3,1,3,3,3,0,0,0,3,3,3,3,1,3,3,3,3,1,3,3,3,3,0,0,3,3,3,1,1,3,3,3,3,1,1,3,3,3,0,3,3,3,3,1,1,3,3,3,3,1,1,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,1,2,1,1,1,1,2,1,3,3,3,3,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,0,2,2,2,1,1,1,1,1,1,1,1,2,2,2,0,0,2,2,1,1,1,1,1,1,1,1,1,1,2,2,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,1,1,0,0,0,3,3,3,3,0,0,0,0,3,3,3,3,0,0,0,0,3,3,3,3,0,0,0,0,3,3,3,3,0,0,3,3,3,3,3,3,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,3,3,3,3,3,3]],palette:[[nesColor[0].cFF,nesColor[0].c16,nesColor[0].c27,nesColor[0].c18],[nesColor[0].cFF,nesColor[0].c30,nesColor[0].c27,nesColor[0].c18],[nesColor[0].cFF,nesColor[0].c37,nesColor[0].c27,nesColor[0].c05]]},floor:{size:[{x:16,y:16}],sprite:[[2,1,1,1,1,1,1,1,1,3,2,1,1,1,1,2,1,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,1,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,1,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,1,2,2,2,2,2,2,2,2,3,1,3,2,2,2,3,1,2,2,2,2,2,2,2,2,3,1,3,3,3,3,2,1,2,2,2,2,2,2,2,2,3,1,1,1,1,1,3,1,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,1,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,1,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,3,3,2,2,2,2,2,2,3,1,2,2,2,2,2,3,1,1,3,3,2,2,2,2,3,1,2,2,2,2,2,3,1,2,1,1,3,3,3,3,1,2,2,2,2,2,2,3,1,2,2,2,1,1,1,3,1,2,2,2,2,2,2,3,1,2,2,2,2,2,2,3,1,2,2,2,2,2,3,3,2,3,3,3,3,3,3,2,1,3,3,3,3,3,3,2]],palette:[[nesColor[0].cFF,nesColor[0].c37,nesColor[0].c17,nesColor[0].c0D],[nesColor[0].cFF,nesColor[0].c31,nesColor[0].c1C,nesColor[0].c0D]]},mushroom:{size:[{x:16,y:16}],sprite:[[0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,3,3,0,0,0,0,0,0,0,0,0,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,2,2,2,2,2,3,3,3,3,3,0,0,0,0,0,2,2,2,2,2,2,2,3,3,3,2,2,0,0,0,2,2,3,3,3,2,2,2,2,2,2,2,2,2,0,0,2,3,3,3,3,3,2,2,2,2,2,2,2,2,0,2,2,3,3,3,3,3,2,2,2,2,2,3,3,2,2,2,2,3,3,3,3,3,2,2,2,2,2,3,3,3,2,2,2,2,3,3,3,2,2,2,2,2,2,2,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,3,3,3,1,1,1,1,1,1,3,3,3,2,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,2,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,2,1,0,0,0,0,0,0,0,0,0,1,1,1,1,2,1,0,0,0,0,0]],palette:[[nesColor[0].cFF,nesColor[0].c20,nesColor[0].c27,nesColor[0].c16]]},qstBlock:{size:[{x:16,y:16}],sprite:[[0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,2,1,3,1,1,1,1,1,1,1,1,1,1,3,1,3,2,1,1,1,1,2,2,2,2,2,1,1,1,1,1,3,2,1,1,1,2,2,3,3,3,2,2,1,1,1,1,3,2,1,1,1,2,2,3,1,1,2,2,3,1,1,1,3,2,1,1,1,2,2,3,1,1,2,2,3,1,1,1,3,2,1,1,1,1,3,3,1,2,2,2,3,1,1,1,3,2,1,1,1,1,1,1,2,2,3,3,3,1,1,1,3,2,1,1,1,1,1,1,2,2,3,1,1,1,1,1,3,2,1,1,1,1,1,1,1,3,3,1,1,1,1,1,3,2,1,1,1,1,1,1,2,2,1,1,1,1,1,1,3,2,1,1,1,1,1,1,2,2,3,1,1,1,1,1,3,2,1,3,1,1,1,1,1,3,3,1,1,1,3,1,3,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]],palette:[[nesColor[0].cFF,nesColor[0].c27,nesColor[0].c17,nesColor[0].c0D]]},brick:{size:[{x:16,y:16}],sprite:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]],palette:[[nesColor[0].cFF,nesColor[0].c37,nesColor[0].c17,nesColor[0].c0D]]},titleScreen:{size:[{x:137,y:86}],sprite:[[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3]],palette:[[nesColor[0].cFF,nesColor[0].c37,nesColor[0].c17,nesColor[0].c0D]]},empty:{sprite:[[]],palette:[[]]}};function backgroundColor(color){c.fillStyle=color,c.fillRect(0,0,canvas.width,canvas.height)}function floor(start,length){for(var a=0;a<2;a++)for(var b=0;b<length;b++)for(var q=0;q<16;q++)for(var i=0;i<16;i++)c.fillStyle=objects.floor.palette[0][objects.floor.sprite[0][i+q*objects.floor.size[0].x]],c.fillRect(i+16*b+16*start,q+208+16*a,1,1)}function drawBackgroundLayer(){backgroundColor(nesColor[0].c21),floor(0,16)}var currentSprite=4,frame=0,xPos=16,yPos=0,isOnGround=!1;function moveMario(){var direction;!0===input.right&&(direction=2),!0===input.left&&(direction=-2),!0===isOnGround&&(xPos+=direction),2<++frame&&(currentSprite++,frame=0),3<currentSprite&&(currentSprite=1)}function drawMario(){for(var q=0;q<objects.mario.size[0].y;q++)for(var i=0;i<objects.mario.size[0].x;i++)c.fillStyle=objects.mario.palette[0][objects.mario.sprite[currentSprite][i+q*objects.mario.size[0].x]],c.fillRect(i+xPos,q+yPos,1,1);256<xPos&&(xPos=-16),xPos<-16&&(xPos=256),!0===input.a&&(isOnGround=!1,yPos--,yPos/=1.2),!1===isOnGround&&(yPos=1.1*++yPos),193<yPos&&(isOnGround=!0),!0===isOnGround&&(yPos=193),!0===isOnGround&&!1===input.right&&!1===input.left&&(currentSprite=0),!1===isOnGround&&!1===input.right&&!1===input.left&&(currentSprite=4)}var tick=0,time=0,speed=0,dist=0;function drawMushroom(x,y){speed<50&&(speed=(time=++tick/60)*time*10),240<(dist+=speed/60*16)&&(dist-=256+y),192<dist&&(dist=192);for(var q=0;q<objects.mushroom.size[0].y;q++)for(var z=0;z<objects.mushroom.size[0].x;z++)c.fillStyle=objects.mushroom.palette[0][objects.mushroom.sprite[0][z+q*objects.mushroom.size[0].x]],c.fillRect(z+x,q+dist+y,1,1)}function drawBrick(x,y){for(var q=0;q<objects.brick.size[0].y;q++)for(var z=0;z<objects.brick.size[0].x;z++)c.fillStyle=objects.brick.palette[0][objects.brick.sprite[0][z+q*objects.brick.size[0].x]],c.fillRect(z+16*x,q+16*y,1,1)}function drawQstBlock(x,y){for(var q=0;q<objects.qstBlock.size[0].y;q++)for(var z=0;z<objects.qstBlock.size[0].x;z++)c.fillStyle=objects.qstBlock.palette[0][objects.qstBlock.sprite[0][z+q*objects.qstBlock.size[0].x]],c.fillRect(z+16*x,q+16*y,1,1)}function spriteViewer(object,size,sprite,pallete){for(var q=0;q<objects.titleScreen.size[size].y;q++)for(var z=0;z<objects.titleScreen.size[size].x;z++)c.fillStyle=objects.titleScreen.palette[pallete][objects.titleScreen.sprite[sprite][z+q*objects.titleScreen.size[size].x]],c.fillRect(z,q,1,1)}function drawSpriteLayer(){drawMario(),drawQstBlock(8,9),drawBrick(11,9),drawQstBlock(12,9),drawBrick(13,9),drawQstBlock(13,5),drawQstBlock(14,9),drawBrick(15,9),drawMushroom(112,0),!0!==input.right&&!0!==input.left||moveMario()}function render(){c.clearRect(0,0,canvas.width,canvas.height),drawBackgroundLayer(),drawSpriteLayer()}setInterval(render,1e3/60);